!function(){"use strict";function t(t){if(t){var e=t.match(/\b(?:[34])[0-9]{2}\b/);if(e)return parseInt(e[0],10);if(t.match(/timeout/i))return t.match(/vpaid|vast/i)?301:402;if(t.match(/found/i))return 401;if(t.match(/supported/i))return 403;if(t.match(/(?:displaying|media file)/i))return 405}return 901}function e(t){for(;t.length>0;){var e=t.pop();e.parentNode&&e.parentNode.removeChild(e)}}function i(t,e,i,n){var r=document.createElement("iframe");r.src="javascript:false",t.style(r,{border:0,width:"100%",height:"100%",position:"absolute",overflow:"hidden"}),r.scrolling="no";var a=i.getElementsByClassName("jw-media")[0];a.appendChild(r);var s=r.contentWindow.document;return s.open().write("\n    <body onload=\"\n        var js = document.createElement('script');\n        js.src = '"+e+"';\n        js.addEventListener('load', function() { window.myCallback(); });\n        document.body.appendChild(js);\"\n    style=\"margin: 0\">"),r.contentWindow.myCallback=n,s.close(),r}function n(t){return{getPosition:function(){var e=t.getPosition();return e},getFile:function(){return t.getPlaylistItem().file}}}function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:900,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:60900,n={};return n.message=t,n.code=e,n.adErrorCode=i,n}function a(t,e){"boolean"==typeof t.mediaFileCompliance&&(e.mediaFileCompliance=t.mediaFileCompliance,t.nonComplianceReasons&&(e.nonComplianceReasons=t.nonComplianceReasons))}function s(t){var e=[];return Ae.map(t,function(t){var i="iframe"===t.type||"html"===t.type?t.type:"static",n=void 0;t.trackers&&t.trackers.creativeView&&t.trackers.creativeView.length&&(n=t.trackers.creativeView),e.push({width:t.width,height:t.height,type:i,resource:t.source,creativeview:n,click:t.clickthrough})}),e}function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=[];return Ae.map(t,function(t){t.type.indexOf("flash")<0&&e.push(t)}),e}function d(t){return"application/javascript"===t.type||"application/x-javascript"===t.type}function l(t){return d(t)?"html5":"flash"}function h(t,e){for(var i=void 0,n="flash"===e,r=0;r<t.media.length;r++){var a=t.media[r];if(n){i=a;break}if("html5"===l(a)){i=a;break}}return i}function p(t,e,i){t.tracker=new ge(t.trackers,e,i)}function u(t,e){var i=void 0;return i="flash"===e?Ae.where(jwplayer.api.availableProviders,{name:"flash"}):Ae.filter(jwplayer.api.availableProviders,function(t){return"flash"!==t.name}),Ae.filter(t,function(t){return Ae.some(i,function(e){return e.supports(t,"ads")})})}function c(t,e,i){var n=document.createElement("param");n.setAttribute("name",e),n.setAttribute("value",i),t.appendChild(n)}function f(t,e){for(var i=0;i<t.length;i++){var n=t[i];e?n._vmap.item=i+1:n._adbreak={item:i+1,tags:n._adQueue,breakid:n._breakId}}}function m(t,e,i){var n=void 0;return we.foreach(t,function(t,e){n=n||{},"_adQueue"===t?n[t]=e.slice():n[t]=e}),n&&(n.requestTimeout=e,n.creativeTimeout=i),n}function v(t,e){return"%"===t.toString().slice(-1)?e*parseFloat(t.slice(0,-1))/100:parseFloat(t)}function y(t){return Ce.isString(t)?[t]:Ce.isArray(t)?t.slice(0):t}function g(t){if("start"===t||"0%"===t)return"pre";if("end"===t||"100%"===t)return"post";if("pre"===t||"post"===t||Ce.indexOf(t,"%")>-1)return t;var e=Ie.seconds(t);return!!Ce.isNumber(e)&&e}function A(t,e){return 0===t?1/0:t||e}function P(t,e){if(!e)return t;var i=t.indexOf("?")>=0?"&":"?",n="cust_params=",r=t.indexOf(n),a=n.length,s="",o="";if(Ie.foreach(e,function(t,e){s=""+s+o+t+"="+e,o="&"}),s=encodeURIComponent(s),r>=0){var d=t.substr(0,r+a),l=t.substr(r+a);return""+d+s+"%26"+l}return""+t+i+"cust_params="+s}function k(t,e){var i=e.schedule||e.adschedule;i&&Object.keys(i).map(function(n){var r=i[n];r.ad&&(Ie.extend(r,r.ad),delete r.ad);var a=g(r.offset),s=A(r.requestTimeout,yt),o=A(r.creativeTimeout,gt),d={_offSet:a,_type:r.type,_breakId:n,requestTimeout:s,creativeTimeout:o};a===!1&&Ie.log("Error: ad offset format not supported",a);var l=r.skipoffset||e.skipoffset;Ce.isUndefined(l)||(d.skipoffset=l);var h=r.adbreakid;h&&(d.adbreakid=h);var p=r.adtagid;if(p&&(d._adTagQueue=y(p)),r.tag){var u=P(r.tag,r.custParams);d._adQueue=y(u),d._waterfallIndex=0}else{if(!Ce.isString(r.vastxml))return void Ie.log("Error: no ad tag provided");d._adXML=r.vastxml}switch(a){case"pre":t.setPreRoll(d);break;case"post":t.setPostRoll(d);break;default:t.addMidRoll(d)}})}function T(t,e){xe.style(t,{opacity:e||1})}function E(t){xe.style(t,{opacity:0})}function w(){T(Le)}function b(){T(Le,.75)}function _(){T(Re)}function C(){T(Re,.5)}function I(t,e){var i=[],n=V(t,"VMAP",vt);if(!n.length)throw new Error("No VMAP tag in response");var r=L(n[0],"version");r||S(i,"VMAP Schema Error: version missing from VMAP tag",nt);var a=V(t,"AdBreak",vt);if(!a.length)throw new Error("No AdBreaks in VMAP");for(var s=t.lookupNamespaceURI(vt),o=0;o<a.length;o++){var d={},l={},h=a[o],p=L(h,"timeOffset"),u=L(h,"breakId"),c=L(h,"breakType"),f=V(h,"AdSource",vt)[0],m=L(f,"id"),v=V(h,"AdTagURI",vt)[0],y=V(h,"VASTData",vt)[0]||V(h,"VASTAdData",vt)[0],g=L(v,"templateType"),A=H(v),P=R(s,h,"Tracking",vt);if(c||S(i,"VMAP Schema Error: missing breakType on AdBreak",u),y||g||S(i,"VMAP Schema Error: missing templateType on AdBreak",u),p||S(i,"VMAP Schema Error: missing timeOffset on AdBreak",u),d._type=c,d._vmap={id:m,breakid:u,timeoffset:p},y)d._adXML=V(y,"VAST")[0];else{if("vast2"!==g&&"vast3"!==g&&"vast4"!==g)continue;d._adQueue=[A],d._waterfallIndex=0}var k=[];if(P)for(var T=0;T<P.length;T++){M(l,P[T]);var E=L(P[T],"event");k.push(E)}switch((k.indexOf("breakStart")<0||k.indexOf("breakEnd")<0||k.indexOf("error")<0)&&S(i,"Tracking events are missing breakStart, breakEnd, or error for AdBreak",u),d._trackers=l,d._type=c,p){case"start":d._offSet="pre",e.setPreRoll(d);break;case"100%":case"end":d._offSet="post",e.setPostRoll(d);break;default:if(/^#/.test(p))break;/^\d\d?(?:\.\d+)?%$/.test(p)?d._offSet=p:d._offSet=Ue.seconds(p),e.addMidRoll(d)}}if(!e.preRoll&&!e.midRolls.length&&!e.postRoll)throw new Error("No AdBreaks in VMAP");return e.sort(null,!0),i}function S(t,e,i){var n=r(e,1002,11002);n.id=i,t.push(n)}function x(t){var e=V(t,"Error");Be.map(e,function(t){var e=H(t),i=new Image;i.src=e})}function V(t,e,i){var n=[];return t&&(n=t.getElementsByTagName(e),i&&n&&0===n.length&&(n=t.getElementsByTagName(i+":"+e))),n}function R(t,e,i,n){var r=[];return t||e?r=e.getElementsByTagNameNS?e.getElementsByTagNameNS(t,i):e.getElementsByTagName(n+":"+i):r}function L(t,e){return t?t.getAttribute(e):null}function M(t,e){var i=L(e,"event");if("progress"===i){var n=L(e,"offset");i=i+"_"+n}var r=H(e);D(t,i,r)}function H(t){if(t){var e=t.textContent||t.text;if(e)return Ue.trim(e)}return""}function D(t,e,i){t[e]||(t[e]=[]),i&&t[e].push(i)}function O(t,e,i){var n=V(t,e);Be.map(n,function(t){D(i,e.toLowerCase(),H(t))})}function j(t){var e={};Be.map(t.media,function(t){var i=t.type,n="application/x-mpegURL"===i||"vnd.apple.mpegURL"===i;"vpaid"===t.adType.toLowerCase()||n||(e[i]=e[i]||0,e[i]++)}),t.mediaFileCompliance=!0,Be.map(e,function(e,i){e<3&&(t.mediaFileCompliance=!1,t.nonComplianceReasons=t.nonComplianceReasons||[],t.nonComplianceReasons.push(i+" has only "+e+" qualities"))})}function U(t){var e=V(V(t,"Creatives")[0],"Creative"),i={},n={trackers:i};n.adsystem=H(V(t,"AdSystem")[0]);var r=[],a=V(t,"Category");return Be.map(a,function(t){r.push(H(t))}),n.categories=r,Be.map(e,function(t){var e=V(t,"Linear")[0],r=V(t,"NonLinear")[0],a=V(V(t,"TrackingEvents")[0],"Tracking"),s=V(t,"UniversalAdId")[0],o=L(s,"idRegistry")||"unknown",d=L(s,"idValue")||"unknown";e||r?(Be.map(a,function(t){M(i,t)}),n.universalAdIdRegistry=o,n.universalAdIdValue=d):(n.companionUniversalAdIdRegistry=o,n.companionUniversalAdIdValue=d);var l=H(V(t,"AdParameters")[0]);if(l&&(n.adParams=l),e){var h=V(e,"VideoClicks")[0],p=H(V(h,"ClickThrough")[0]),u=V(h,"ClickTracking"),c=L(e,"skipoffset"),f=H(V(e,"Duration")[0]);Be.map(u,function(t){D(i,"click",H(t))}),f&&(n.duration=Ue.seconds(f)),p&&(n.clickthrough=p),c&&(n.skipoffset=c),N(e,n)}else if(r){var m=H(V(r,"NonLinearClickThrough")[0]);m&&(n.clickthrough=m),F(t,n)}else q(t,n)}),n}function B(t){var e=V(t,"Video")[0]||t,i=V(t,"NonLinear")[0],n={},r={trackers:n};if(e){var a=V(V(t,"TrackingEvents")[0],"Tracking");Be.map(a,function(t){M(n,t)});var s=V(V(t,"Impression")[0],"URL");Be.map(s,function(t){D(n,"impression",H(t))});var o=V(V(t,"Error")[0],"URL");Be.map(o,function(t){D(n,"error",H(t))});var d=V(e,"VideoClicks")[0],l=H(V(d,"ClickThrough")[0]),h=V(V(d,"ClickTracking")[0],"URL");Be.map(h,function(t){D(n,"click",H(t))}),l&&(r.clickthrough=l),N(e,r);var p=V(e,"AdParameters")[0];if(p){var u=L(p,"apiFramework");"vpaid"===u.toLowerCase()&&(Be.map(r.media,function(t){t.adType=u}),r.adParams=H(p))}}if(i){var c=r.media||[],f=V(i,"URL")[0];c.push({type:L(i,"creativeType"),file:H(f),adType:L(i,"apiFramework")}),r.media=c}var m=V(t,"CompanionAds")[0];return m=V(m,"Companion"),r.companions||(r.companions=[]),Be.map(m,function(t){r.companions.push({width:parseInt(L(t,"width"),10),height:parseInt(L(t,"height"),10),type:L(t,"resourceType"),resource:H(V(t,"URL")[0]),trackers:[],clickthrough:""})}),r}function N(t,e){var i=V(V(t,"MediaFiles")[0],"MediaFile"),n=e.media?e.media:[];Be.map(i,function(t){var e={type:L(t,"type"),file:H(t),adType:L(t,"apiFramework")||"",width:parseInt(L(t,"width"),10)||0,height:parseInt(L(t,"height"),10)||0};e.file&&n.push(e)}),e.media=n}function F(t,e){var i=[],n=V(t,"StaticResource")[0];n&&(i.push({type:L(n,"creativeType"),file:H(n),adType:L(V(t,"NonLinear")[0],"apiFramework")||"static",minDuration:L(V(t,"NonLinear")[0],"minSuggestedDuration")||"00:00:00"}),e.media=i)}function q(t,e){var i=V(V(t,"CompanionAds")[0],"Companion"),n=e.companions?e.companions:[];Be.map(i,function(t){var e=V(t,"StaticResource")[0],i=V(t,"IFrameResource")[0],r=V(t,"HTMLResource")[0],a={},s=void 0,o=void 0;if(e)s=L(e,"creativeType"),o=H(e);else if(i)s="iframe",o=H(i);else{if(!r)return;s="html",o=H(r)}var d=V(V(t,"TrackingEvents")[0],"Tracking");Be.map(d,function(t){var e=L(t,"event");D(a,e,H(t))});var l=H(V(t,"CompanionClickThrough")[0]);n.push({width:parseInt(L(t,"width"),10),height:parseInt(L(t,"height"),10),type:s,source:o,trackers:a,clickthrough:l})}),e.companions=n}function Q(t,e){var i=Ue.extend({},t);return Ue.foreach(e,function(t,n){Ue.exists(i[t])?"array"===Ue.typeOf(n)?i[t]=i[t].concat(n):"object"===Ue.typeOf(n)?i[t]=Ue.extend(i[t],e[t]):i[t]=n:i[t]=n}),i}function X(t){t&&(t.onload=null,t.onreadystatechange=null,t.onerror=null,t.abort&&t.abort())}function W(t,e,i){var n=[];return i.foreach(e,function(e,r){t.companions&&(r.companions=(r.companions?r.companions:[]).concat(t.companions)),t.trackers&&(r.trackers=z(r.trackers,t.trackers,i)),t.sequence&&(r.sequence=t.sequence),n.push(r)}),n}function z(t,e,i){return t=t||{},i.foreach(e,function(e,i){t[e]?t[e]=t[e].concat(i):t[e]=i}),t}function G(t,e){return K(t)?t:e.parseXML(t)}function K(t){return"object"==typeof Node?t instanceof Node:t&&"object"==typeof t&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName}function Y(t,e,i,n){if(!t)return t;var r=Z(e),a=r.item,s=window.location.href;t=J(t,"__random-number__",Math.random()*Math.pow(10,18)),t=J(t,"__timestamp__",(new Date).getTime()),t=J(t,"__page-url__",encodeURIComponent(s)),t=J(t,"__referrer__",encodeURIComponent(document.referrer)),t=J(t,"__player-height__",r.playerHeight),t=J(t,"__player-width__",r.playerWidth),t=J(t,"__item-duration__",r.itemDuration),t=J(t,"__domain__",encodeURIComponent(i)),t=n.companion?J(t,"__companion-div__",n.companion.id):J(t,"__companion-div__","");for(var o=t.match(new RegExp(/__item-[a-z 0-9 A-Z]*__/g)),d=0;o&&d<o.length;d++){var l=o[d],h=l.substring(7,l.length-2);if(a.hasOwnProperty(h)&&e._.isString(a[h])){var p=a[h];p.length>1e3&&(p=p.substring(0,1e3)),t=J(t,l,encodeURIComponent(p))}else t=J(t,l,"")}return t=$(t)}function $(t){return Xe.test(t)||We.test(t)?t+="&sdk3p=jwplayer":ze.test(t)&&(t+=";sdk3p=jwplayer"),t}function J(t,e,i){return t.replace(e,i)}function Z(t){var e=t.getConfig();return{playerHeight:t.getHeight()||e.height||"",playerWidth:t.getWidth()||e.width||"",itemDuration:tt(t.getDuration(),3)||"",item:e.playlist[t.getPlaylistIndex()]||{}}}function tt(t,e){var i=Math.pow(10,e);return Math.round(t*i)/i}function et(t){return t._adQueue&&t._waterfallIndex<t._adQueue.length}var it="vast",nt="-1",rt="This ad will end in xx",at="Ad __AD_POD_CURRENT__ of __AD_POD_LENGTH__. ",st=-1,ot="Advertisement",dt="Skip ad in xx",lt="Skip",ht="time",pt="[ERRORCODE]",ut="[CACHEBUSTING]",ct="[ASSETURI]",ft="[TIMESTAMP]",mt="[CONTENTPLAYHEAD]",vt="vmap",yt=5e3,gt=15e3,At="state",Pt="buffering",kt="paused",Tt="idle",Et="playing",wt="complete",bt="fullscreen",_t="volume",Ct="mute",It="error",St="adClick",xt="adCompanions",Vt="adComplete",Rt="adError",Lt="adImpression",Mt="beforePlay",Ht="adMeta",Dt="adPause",Ot="adPlay",jt="adSkipped",Ut="adTime",Bt="adStarted",Nt="none",Ft="auto",qt={QUARTILE:"quartile",REMAINING_TIME:"remainingTimeChange",SKIPPED:"skipped",STARTED:"started",STOPPED:"stopped",CLICK:"click",PLAY:"play",IMPRESSION:"impression",PAUSE:"pause",ERROR:"error",COMPLETE:"complete",CLOSE:"close",EXPANDED_CHANGE:"expandedChange"},Qt="AdLoaded",Xt="AdStarted",Wt="AdStopped",zt="AdLinearChange",Gt="AdExpandedChange",Kt="AdRemainingTimeChange",Yt="AdVideoFirstQuartile",$t="AdVideoMidpoint",Jt="AdVideoThirdQuartile",Zt="AdVideoComplete",te="AdClickThru",ee="AdPaused",ie="AdPlaying",ne="AdSkipped",re="AdError",ae="fullscreen",se="normal",oe=60,de=66,le=150,he=[Lt,Rt,"adPodError"],pe=[Bt,Vt,Lt,St,jt,Rt,Ot,Dt,Ht],ue=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},ce=function(){function t(e,i,n,r,a,s){var o=this;ue(this,t),this.player=e,this.utils=e.utils,this.environment=e.getEnvironment(),this._=e._,this.swf=i,this.adTag=r,this.adParams=a,this.vpaidControls=s,this.resumeOnAdStopped=!1,this.paused=!1,this.flashThrottled=!1,this.type="vpaid",this.blocking=null,this.vpaidState={linear:!1,expanded:!1,remainingTime:-1};var d=-1;this._.extend(this,e.Events),this.environment.Browser.chrome&&this.swf.on("throttle",function(t){clearTimeout(d),"resume"===t.state?(o.flashThrottled=!1,o.onAdPlaying(o.vpaidState),o.setPointerEventsStyle(Nt),o.callVPAID("resumeAd")):d=setTimeout(function(){o.setPointerEventsStyle(Ft),o.callVPAID("pauseAd"),o.onAdPaused(o.vpaidState),o.flashThrottled=!0},250)},this),this.swf.triggerFlash("vast:loadVpaid",n,this.genCallback(this.vpaidLoadSuccess.bind(this)),this.genCallback(this.vpaidError.bind(this)))}return t.prototype.vpaidLoadSuccess=function(){this.setPointerEventsStyle(Ft),this.addVPAIDListener(Qt,this.onAdLoaded),this.addVPAIDListener(Xt,this.onAdStarted),this.addVPAIDListener(zt,this.onLinearChange),this.addVPAIDListener(Gt,this.onExpandedChange),this.addVPAIDListener(ee,this.onAdPaused),this.addVPAIDListener(ie,this.onAdPlaying),this.addVPAIDListener(Wt,this.onAdStopped),this.addVPAIDListener(Zt,this.onAdComplete),this.addVPAIDListener(Kt,this.onRemainingTimeChangeHandler),this.addVPAIDListener(te,this.onAdClick),this.addVPAIDListener(ne,this.onAdSkipped),this.addVPAIDListener(re,this.vpaidError),this.addVPAIDListener(Yt,this.onFirstQuartile),this.addVPAIDListener($t,this.onMidpoint),this.addVPAIDListener(Jt,this.onThirdQuartile);var t=this.player.getSafeRegion(!1);this.callVPAID("initAd",t.width,t.height+t.y,this.fullscreenMode(),0,this.adParams)},t.prototype.setPointerEventsStyle=function(t){this.environment.Browser.ie&&"PointerEvent"in window&&(this.swf.style.pointerEvents=t)},t.prototype.fullscreenMode=function(){return this.player.getFullscreen()?"fullscreen":"normal"},t.prototype.vpaidError=function(){this.sendEvent(qt.ERROR)},t.prototype.sendEvent=function(t,e){this.flashThrottled||(e=e||{},e.linear=this.vpaidState.linear?"linear":"nonlinear",e.tag=this.adTag,this.trigger(t,e))},t.prototype.updateVpaidState=function(t){t&&(this._.isBoolean(t.linear)&&(this.vpaidState.linear=t.linear),this._.isBoolean(t.expanded)&&(this.vpaidState.expanded=t.expanded),this._.isNumber(t.remainingTime)&&(this.vpaidState.remainingTime=t.remainingTime))},t.prototype.onAdLoaded=function(t){this.onLinearChange(t),this.setVPAIDProperty("adVolume",this.player.getMute()?0:this.player.getVolume()/100),this.callVPAID("startAd")},t.prototype.onAdStarted=function(t){this.updateVpaidState(t),t.linear&&this.blocking&&!this.vpaidControls&&this.blocking.hide(),this.sendEvent(qt.IMPRESSION),this.sendEvent(qt.PLAY,{oldstate:Pt,newstate:Et}),this.sendEvent(qt.STARTED)},t.prototype.onAdClick=function(t){this.updateVpaidState(t),this.sendEvent(qt.CLICK,{url:t.url,playerHandles:t.playerHandles})},t.prototype.onAdSkipped=function(t){this.updateVpaidState(t),this.sendEvent(qt.SKIPPED)},t.prototype.onLinearChange=function(t){this.updateVpaidState(t);var e=void 0,i=void 0,n=void 0;if(t.linear){if(this.blocking)this.vpaidControls||this.blocking.hide();else{this.resumeOnAdStopped=!0,this.player.setControls(!1);var r=this.player.getState();r!==Et&&r!==Pt||this.player.pause()}n=this.player.getSafeRegion(!1),i=n.height+n.y,e=n.width}else this.blocking?(this.blocking.destroy(),this.blocking=null):this.resumeOnAdStopped&&(this.player.play(),this.player.setControls(!0)),n=this.player.getSafeRegion(!0),i=n.height+n.y,e=n.width;this.callVPAID("resizeAd",e,i,this.fullscreenMode())},t.prototype.onExpandedChange=function(t){this.updateVpaidState(t),this.sendEvent(qt.EXPANDED_CHANGE,{expanded:this.vpaidState.expanded})},t.prototype.onAdStopped=function(t){this.updateVpaidState(t),this.resumeOnAdStopped&&(this.player.play(),this.player.setControls(!0)),this.setPointerEventsStyle(Nt),this.sendEvent(qt.STOPPED)},t.prototype.onAdComplete=function(){this.setPointerEventsStyle(Nt),this.sendEvent(qt.COMPLETE)},t.prototype.onAdPaused=function(t){this.updateVpaidState(t),this.paused||(this.paused=!0,this.sendEvent(qt.PAUSE,{newstate:kt,oldstate:Et}))},t.prototype.onAdPlaying=function(t){this.updateVpaidState(t),this.paused&&(this.paused=!1,this.sendEvent(qt.PLAY,{newstate:Et,oldstate:kt}))},t.prototype.onRemainingTimeChangeHandler=function(t){this.updateVpaidState(t),this.sendEvent(qt.REMAINING_TIME,{remainingTime:t.remainingTime})},t.prototype.onFirstQuartile=function(t){this.handleQuartile(1,t)},t.prototype.onMidpoint=function(t){this.handleQuartile(2,t)},t.prototype.onThirdQuartile=function(t){this.handleQuartile(3,t)},t.prototype.handleQuartile=function(t,e){this.updateVpaidState(e),this.sendEvent("quartile",{quartile:t,remainingTime:e.remainingTime})},t.prototype.callVPAID=function(){var t=Array.prototype.slice.call(arguments);t.unshift("vast:callVpaid"),this.swf.triggerFlash.apply(this.swf,t)},t.prototype.setVPAIDProperty=function(t,e){this.swf.triggerFlash("vast:setVpaidProperty",t,e)},t.prototype.addVPAIDListener=function(t,e){this.swf.triggerFlash("vast:addVpaidListener",t,this.genCallback(e.bind(this)))},t.prototype.genCallback=function(t){var e=t.name?t.name.replace("bound ",""):"",i=this.player.id+":vast:"+e+":"+Math.random().toString(16).substr(2);return this.swf.on(i,t,this),i},t.prototype.genEvent=function(t){var e=this;return function(i){e.on(t,i)}},t.prototype.setVolume=function(t){this.setVPAIDProperty("adVolume",t/100)},t.prototype.volume=function(){},t.prototype.mute=function(){},t.prototype.play=function(){this.callVPAID("resumeAd")},t.prototype.pause=function(){this.callVPAID("pauseAd")},t.prototype.stop=function(){this.callVPAID("stopAd")},t.prototype.resize=function(){var t=this.player.getSafeRegion(!this.vpaidState.linear);this.callVPAID("resizeAd",t.width,t.height+t.y,this.fullscreenMode())},t.prototype.removeEvents=function(){this.off()},t.prototype.destroy=function(){this.removeEvents(),this.setPointerEventsStyle(Nt),this.swf.off(null,null,this),this.blocking=null},t.prototype.getState=function(){return this.vpaidState.linear?this.paused?kt:Et:Tt},t}(),fe=function(){function n(t,e,r,a,s,o){var d=this;return ue(this,n),this.player=t,this._=t._,this.state=t.state,this.vpaidURL=e,this.adTag=r,this.adParams=a,this.vpaidControls=s,this.type="vpaid",this.blocking=null,this.toRemove=[],this.vpaidState={linear:!1,expanded:!1,remainingTime:-1},this.paused=!1,this._.extend(this,t.Events),this.setMuteCallback=this.setMute.bind(this),this.playerContainer=this.player.getContainer(),o?void setTimeout(function(){d.sendEvent("error",{message:"Conditional ad rejected",code:408})},0):(this.iframe=i(t.utils,this.vpaidURL,this.playerContainer,this.callback.bind(this)),void this.toRemove.push(this.iframe))}return n.prototype.sendEvent=function(t,e){e=e||{},e.tag||(e.tag=this.adTag),this.trigger(t,e)},n.prototype.sendTimeEvent=function(t,e,i){var n=e.getAdDuration(),r=e.getAdRemainingTime(),a=this._.extend({duration:n},i);this.sendEvent(t,a),r>0&&(a.position=n-r,this.trigger("time",a))},n.prototype.handleQuartile=function(t,e){this.sendTimeEvent("quartile",t,{quartile:e})},n.prototype.genEvent=function(t){var e=this;return function(i){e.on(t,i)}},n.prototype.setMute=function(){this.player.setMute(!this.vpaidAd.getAdVolume())},n.prototype.userActive=function(){var t=this.player.utils.hasClass(this.playerContainer,"jw-flag-time-slider-above");this.player.utils.style(this.iframe,{bottom:t?de:oe})},n.prototype.userInactive=function(){"paused"!==this.player.getState()&&this.player.utils.style(this.iframe,{bottom:"0.5em"})},n.prototype.prepareNonlinearAd=function(){var t=!this.player.utils.hasClass(this.playerContainer,"jw-flag-user-inactive");this.player.utils.style(this.iframe,{height:le}),this.resize(null,le),this.userActive(t),this.player.on("userActive",this.userActive,this),this.player.on("userInactive",this.userInactive,this),this.blocking&&(this.blocking.applyProviderListeners(null),this.blocking.destroy(),this.blocking=null)},n.prototype.genListeners=function(i){var n=this;return{AdLoaded:function(){i.startAd()},AdStarted:function(){i.getAdLinear()?n.blocking&&!n.vpaidControls&&n.blocking.hide():n.prepareNonlinearAd(),n.sendEvent("impression",{linear:i.getAdLinear()?"linear":"nonlinear"}),n.sendEvent("play",{oldstate:Pt,newstate:Et,linear:i.getAdLinear()?"linear":"nonlinear"}),i.subscribe(n.setMuteCallback,"AdVolumeChange",i)},AdVideoStart:function(){n.sendEvent("started")},AdStopped:function(){e(n.toRemove),n.player.getConfig().controls&&n.player.setControls(!0),n.sendEvent("stopped")},AdPaused:function(){n.paused||(n.paused=!0,n.sendEvent("pause",{newstate:kt,oldstate:Et}))},AdPlaying:function(){n.paused&&(n.paused=!1,n.sendEvent("play",{newstate:Et,oldstate:kt,linear:i.getAdLinear()?"linear":"nonlinear"}))},AdLinearChange:function(){if(i.getAdLinear())if(n.player.utils.style(n.iframe,{height:"100%"}),n.player.off(null,null,n),n.blocking)n.vpaidControls||n.blocking.hide();else{n.player.setControls(!1);var t=n.player.getState();t!==Et&&t!==Pt||n.player.pause(!0)}else n.prepareNonlinearAd(),n.player.play(),n.player.setControls(!0)},AdDurationChange:function(){n.sendTimeEvent("remainingTimeChange",i,{isDurationChange:!0,remainingTime:i.getAdRemainingTime()})},AdRemainingTimeChange:function(){n.sendTimeEvent("remainingTimeChange",i,{remainingTime:i.getAdRemainingTime()})},AdExpandedChange:function(){n.sendEvent("expandedChange",{expanded:i.getAdExpanded()})},AdSkipped:function(){e(n.toRemove),n.player.getConfig().controls&&n.player.setControls(!0),n.sendEvent("skipped")},AdVideoFirstQuartile:function(){n.handleQuartile(i,1)},AdVideoMidpoint:function(){n.handleQuartile(i,2)},AdVideoThirdQuartile:function(){n.handleQuartile(i,3)},AdVideoComplete:function(){n.sendEvent("complete")},AdUserClose:function(){n.sendEvent("close")},AdClickThru:function(t,e,i){n.sendEvent("click",{id:e,url:t,playerHandles:i})},AdError:function(i){e(n.toRemove);var r=t(i);n.sendEvent("error",{message:i,code:r,adErrorCode:5e4+r})}}},n.prototype.callback=function(){var t=this.vpaidAd=this.iframe.contentWindow.getVPAIDAd(),e=this.player.getMute()?0:this.player.getVolume()/100,i=t.handshakeVersion("2.0");if(parseFloat(i)<1)throw new Error("Invalid vpaid version in handshake");this.listeners=this.genListeners(t),this._.each(this.listeners,t.subscribe,t);var n="normal",r=1e3,a={AdParameters:this.adParams},s=this.playerContainer.getElementsByClassName("jw-media")[0],o=this.video=s.getElementsByTagName("video")[0],d=this.iframe.contentWindow.document.createElement("div");d.className="jw-vpaid-wrapper",d.style.height="100%",this.iframe.contentWindow.document.body.appendChild(d),o?o.removeAttribute("preload"):(o=this.video=document.createElement("video"),o.setAttribute("webkit-playsinline",""),o.setAttribute("playsinline",""),s.insertBefore(o,this.iframe),this.toRemove.push(o));var l={videoSlot:o,slot:d};t.initAd(s.clientWidth,s.clientHeight,n,r,a,l),t.setAdVolume(e)},n.prototype.play=function(){this.vpaidAd.resumeAd()},n.prototype.pause=function(){this.vpaidAd.pauseAd()},n.prototype.stop=function(){if(this.vpaidAd)try{this.vpaidAd.stopAd()}catch(t){console.log("Unhandled exception from VPAID2 Creative stopAd",t)}},n.prototype.setVolume=function(t){this.vpaidAd.setAdVolume(t/100)},n.prototype.resize=function(t,e){if(this.vpaidAd&&this.vpaidAd.resizeAd){var i=this.player.getFullscreen()||document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen,n=i?ae:se;this.vpaidAd.resizeAd(t||this.player.getWidth(),e||this.player.getHeight(),n)}},n.prototype.destroy=function(){if(e(this.toRemove),this.removeEvents(),this.vpaidAd)try{this._.each(this.listeners,this.vpaidAd.unsubscribe,this.vpaidAd),this.vpaidAd.unsubscribe(this.setMuteCallback,"AdVolumeChange")}catch(t){console.log("Unhandled exception from VPAID2 Creative",t)}this.blocking=null},n.prototype.removeEvents=function(){this.player.off(null,null,this),this.off()},n.prototype.attachMedia=function(){},n.prototype.detachMedia=function(){},n.prototype.volume=function(){},n.prototype.mute=function(){},n.prototype.getState=function(){return this.vpaidState.linear?this.paused?kt:Et:Tt},n}(),me=jwplayer.utils,ve=jwplayer._,ye=[],ge=function(){function t(e,i,r){var a=this;ue(this,t),this.map=e,this.debugTrackFn=i,this.trackerPlayerUtils=n(r),this.lastQuartile=0,this.progressEvents=[],this.started=!1,this.firedError=!1,this.hasComp=!1,ve.map(e,function(t,i){if(e.hasOwnProperty(i)&&0===i.indexOf("progress")){var n=""+i.split("_")[1],r={key:i,offset:n,tracked:!1,percentage:!1};/^\d+%$/.test(n)?(r.percentage=!0,r.offset=parseFloat(n)):r.offset=me.seconds(n),a.progressEvents.push(r)}}),this.setFactories()}return t.prototype.getUrls=function(t){return this.map.hasOwnProperty(t)?this.map[t]:[]},t.prototype.addUrl=function(t,e){this.map.hasOwnProperty(t)?this.map[t].push(e):(this.map[t]=[],this.map[t].push(e))},t.prototype.trackPings=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.getUrls(t),n=[],r=[];e=this.replaceMacros(e),ve.map(i,function(t){if(t){ve.each(e,function(e,i){t=t.replace(i,e)});var i=new Image;i.src=t,n.push(t),r.push(i)}});for(var a=ye.length;a--&&(ye[a].width||ye[a].complete);)ye.length=a;Array.prototype.push.apply(ye,r),ve.isFunction(this.debugTrackFn)&&this.debugTrackFn({type:"ping",data:{pingType:t,urls:n,images:r}})},t.prototype.replaceMacros=function(t){return t[ft]=encodeURIComponent(this.generateTimestamp()),t[ut]=Math.random().toString().slice(2,10),t[ct]=encodeURIComponent(this.trackerPlayerUtils.getFile()),t[mt]=encodeURIComponent(this.convertPlayheadOffset(this.trackerPlayerUtils.getPosition())),t},t.prototype.generateTimestamp=function(){var t=new Date,e=t.getTime(),i=t.getTimezoneOffset()/60,n=6e4*t.getTimezoneOffset(),r=new Date(e-n),a=r.toISOString().slice(0,-1)+(i>0?"-":"+")+("0"+i).slice(-2);return a},t.prototype.convertPlayheadOffset=function(t){var e=("0"+Math.floor(t/3600)).slice(-2),i=("0"+Math.floor((t-3600*e)/60)).slice(-2),n=("0"+Math.floor(t-3600*e-60*i)).slice(-2),r=(t%1).toFixed(3).toString().slice(2,5),a=e+":"+i+":"+n+"."+r;return a},t.prototype.start=function(){this.started=!0,this.trackPings("start")},t.prototype.breakStart=function(){this.started=!0,this.trackPings("breakStart")},t.prototype.time=function(t,e){if(!(e<=1)){for(var i=(4*t+.05)/e|0;i>this.lastQuartile&&this.lastQuartile<3;)this.lastQuartile++,1===this.lastQuartile?this.trackPings("firstQuartile"):2===this.lastQuartile?this.trackPings("midpoint"):3===this.lastQuartile&&this.trackPings("thirdQuartile");this.trackProgress(t,e)}},t.prototype.trackProgress=function(t,e){for(var i=this.progressEvents.length;i--;){var n=this.progressEvents[i];if(!n.tracked){var r=n.offset;n.percentage&&(r=e*r/100),t>=r&&(n.tracked=!0,this.trackPings(n.key))}}},t.prototype.error=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:900;this.firedError=!0;var e={};e[pt]=t,this.trackPings("error",e)},t.prototype.factory=function(t){var e=this;return function(){e.trackPings(t)}},t.prototype.setFactories=function(){this.creativeView=this.factory("creativeView"),this.click=this.factory("click"),this.skip=this.factory("skip"),this.complete=this.factory("complete"),this.pause=this.factory("pause"),this.resume=this.factory("resume"),this.mute=this.factory("mute"),this.unmute=this.factory("unmute"),this.fullscreen=this.factory("fullscreen"),this.expand=this.factory("expand"),this.collapse=this.factory("collapse"),this.acceptInvitation=this.factory("acceptInvitation"),this.close=this.factory("close"),this.rewind=this.factory("rewind"),this.impression=this.factory("impression"),this.breakEnd=this.factory("breakEnd")},t}(),Ae=jwplayer._,Pe=function(){function t(e,i,n,r,a,s){ue(this,t),this.player=i,this.utils=i.utils,this._=i._,this.staticPlayer=n,this.companion=r,this.optionalParams=a,this.debugTrackFn=s,this.scheduledAd=e.scheduledAd(),this.vastBuffet=e.adBuffet(),this.vastAdPod=e.adPod(),this.vastAd=this.vastBuffet.length?this.vastBuffet[0]:null,this.adType=null,this.vpaidPlayer=null,this.instreamPlayer=null,this.blockingInstreamPlayer=null,this.mediaType=null,this.adPodItems=null,this.creativeTimeout=null,this.vastOptions=null,this.duration=0,this.adPodIndex=0,this.initialIndex=0,this.utils.extend(this,i.Events)}return t.prototype.init=function(t){this.init=function(){throw new Error("Adplayer can only be initialized once")},this.blockingInstreamPlayer=t;var e=this.prepareAdPod();return!!e&&(this.playAd(),this.player.on("fullscreen",this.playerFullscreenHandler,this),this.player.on("volume",this.playerVolumeHandler,this),this.player.on("mute",this.muteHandler,this),this.player.on("resize",this.playerResizeHandler,this),!0)},t.prototype.getProviderType=function(){var t=this.player.getProvider();return 0===t.name.indexOf("flash")?"flash":t.name},t.prototype.flashSwf=function(){var t=this.player.getContainer();return t.querySelector("object")},t.prototype.prepareAdPod=function(){var t=this,e=null,i=0,n=[],r=this.getProviderType();if(this.vastAd&&(p(this.vastAd,this.debugTrackFn,this.player),e=this.prepareAdPodItem(this.vastAd),e&&"vpaid"===e.adType&&!h(this.vastAd,r)&&(e=null)),this.vastAdPod)for(var a=null,s=0;s<this.vastAdPod.length;s++){var o=this.vastAdPod[s];p(o,this.debugTrackFn,this.player);var d=this.prepareAdPodItem(o);if(d){if(a!==d.adType&&"instream"===a)break;if(a=d.adType,"vpaid"!==d.adType||h(o,r)){var l=n.length+i===s;d&&l&&n.push(d)}else i++}else i++}if(!n.length&&!e)return this.adError("No Compatible Creatives",403),!1;var u=void 0;return n.length?(u=n,this.vastOptions=[],this._.map(u,function(e){t.vastOptions.push(t.getInstreamOptions(e.vastAd))})):(u=e,this.vastOptions=this.getInstreamOptions(this.vastAd)),this.adPodItems=u,this.adPodIndex=0,!0},t.prototype.prepareAdPodItem=function(t){t.tracker.linear="linear";var e=this.getProviderType(),i=(""+t.media[0].adType).toLowerCase()||"instream";"vpaid"!==i||h(t,e)||(i="instream");var n={vastAd:t,sources:[],adType:i};this.scheduledAd.skipoffset&&(n.skipoffset=this.scheduledAd.skipoffset);var r=t.media,a={};if(this._.map(r,function(t){n.sources.push({file:t.file,mimeType:t.type,type:(""+t.type).replace(/^(?:video|audio)\/(?:x-)?/,"")
}),a[t.file]={width:t.width||0,height:t.height||0}}),"instream"===i&&(n.sources=u(n.sources,e)),0===n.sources.length)return null;this.mediaType=(""+n.sources[0].mimeType).toLowerCase(),n.vastAd.selectedMedia=n.sources[0];var s=this.player.getSafeRegion(!0),o=null,d=null;return this._.map(n.sources,function(t){var e=a[t.file];e.width<=s.width&&(!o||e.width>a[o.file].width)&&(o=t),e.width>=s.width&&(!d||e.width<a[d.file].width)&&(d=t)}),o?(n.vastAd.selectedMedia=o,o["default"]=!0):d&&(n.vastAd.selectedMedia=d,d["default"]=!0),n},t.prototype.getInstreamOptions=function(t){var e=this.optionalParams.skipoffset>=0?this.optionalParams.skipoffset:null;return{skipoffset:t.skipoffset||this.scheduledAd.skipoffset||e,skipMessage:this.optionalParams.skipMessage,skipText:this.optionalParams.skipText}},t.prototype.getVastAd=function(t){if(this.adPodItems){var e=void 0;if(e=this.adPodItems.length?this.adPodItems[t]:this.adPodItems,e.vastAd)return e.vastAd}else if(this.vastAdPod&&this.vastAdPod.length)return this.vastAdPod[t];return this.vastAd},t.prototype.adError=function(t,e,i){clearTimeout(this.creativeTimeout);var n=this.getVastAd(this.adPodIndex);i=i||(e?1e4+e:null);var s=r(t,e,i);if(a(n,s),this.vastAdPod&&this.adPodIndex<this.vastAdPod.length-1)return void this.triggerEvent("adPodError",s);var o=n.tracker;o.error(s.code),n.wrappedTags&&(s.wrappedTags=n.wrappedTags),this.addConditionalAdData(s),this.triggerEvent(Rt,s)},t.prototype.playAd=function(){var t=this.adPodItems[this.adPodIndex]||this.adPodItems;if(this.adType=t.adType,"vpaid"===this.adType)this.playVpaid(t.vastAd);else if("static"===this.adType)this.playStatic(),this.clearBlocking();else{var e=this._.isArray(this.adPodItems)?this.adPodItems.slice(this.adPodIndex):this.adPodItems,i=this._.isArray(this.vastOptions)?this.vastOptions.slice(this.adPodIndex):this.vastOptions;this.initialIndex=this.adPodIndex,this.playInstream(e,i),this.clearBlocking()}},t.prototype.clearVpaidBlocking=function(){if(this.vpaidPlayer.blocking){var t=this.vpaidPlayer.blocking;this.vpaidPlayer.blocking=null,this.clearBlocking(t)}},t.prototype.clearBlocking=function(t){t=t||this.blockingInstreamPlayer,t&&t!==this.instreamPlayer&&t.destroy()},t.prototype.getState=function(){return this.instreamPlayer?this.instreamPlayer.getState():this.vpaidPlayer?this.vpaidPlayer.getState():""},t.prototype.clearNonlinear=function(){this.staticPlayer.stop(),this.vpaidPlayer&&(this.clearVpaidBlocking(),this.vpaidPlayer&&(this.vpaidPlayer.stop(),this.vpaidPlayer.destroy(),this.vpaidPlayer=null))},t.prototype.destroy=function(){this.off(),this.removePlayerListeners(),this.instreamPlayer&&this.instreamPlayer.destroy(),this.vpaidPlayer&&(this.clearVpaidBlocking(),this.vpaidPlayer&&this.vpaidPlayer.destroy()),this.clearNonlinear(),this.vastLoader=null,this.player=null,this.vpaidPlayer=null,this.instreamPlayer=null,this.scheduledAd=null,this.vastBuffet=null,this.vastAd=null,this.vastAdPod=null},t.prototype.pause=function(){this.instreamPlayer?this.instreamPlayer.pause():this.vpaidPlayer&&this.vpaidPlayer.pause()},t.prototype.play=function(){this.instreamPlayer?this.instreamPlayer.play():this.vpaidPlayer&&this.vpaidPlayer.play()},t.prototype.removePlayerListeners=function(){this.player&&(this.player.off(bt,this.playerFullscreenHandler,this),this.player.off(_t,this.playerVolumeHandler,this),this.player.off(Ct,this.muteHandler,this)),this.instreamPlayer&&this.instreamPlayer.off(),this.vpaidPlayer&&(this.vpaidPlayer.removeEvents(),this.clearVpaidBlocking(),this.vpaidPlayer&&this.vpaidPlayer.destroy()),this.staticPlayer.stop(),this.staticPlayer.removeEvents()},t.prototype.adEventObject=function(t){var e=this.scheduledAd._adQueue||{},i={id:this.scheduledAd._id,tag:this.scheduledAd._currentTag,client:"vast",witem:this.scheduledAd._waterfallIndex||1,wcount:e.length||1,viewable:this.player.getViewable()};if(this.scheduledAd._adbreak&&(i.adschedule=this.scheduledAd._adbreak,i.adschedule.offset=this.scheduledAd._offSet),this.adPodItems&&this.adPodItems.length&&(i.sequence=this.adPodIndex+1,i.podcount=this.adPodItems.length),this.mediaType&&(i.creativetype=this.mediaType),this.scheduledAd._vmap&&(i.vmap=this.scheduledAd._vmap),pe.indexOf(t)!==-1){var n=this.getVastAd(this.adPodIndex);i.universalAdIdRegistry=n.universalAdIdRegistry,i.universalAdIdValue=n.universalAdIdValue,i.categories=n.categories}return i},t.prototype.playStatic=function(){this.vastAd.tracker.linear="nonlinear";var t=this.vastAd.media[0];this.vastAd.selectedMedia=t;var e=this.vastAd.clickthrough||"",i=this.staticPlayer;i.removeEvents(),i.on("play",this.impressionHandler,this),i.on("play",this.playHandler,this),i.on("complete",this.combinedCompleteHandler,this),i.on("click",this.clickStaticHandler,this),i.on("error",this.staticErrorHandler,this),i.playAd(t.file,e,t.minDuration,this.scheduledAd._currentTag,this.scheduledAd.requestTimeout)},t.prototype.creativeAdError=function(t,e,i){this.adError(t,e,i),this.adPodItems&&this.adPodItems.length-1>this.adPodIndex&&(this.vpaidPlayer&&this._.isFunction(this.vpaidPlayer.destroy)&&this.vpaidPlayer.destroy(),this.adPodIndex++,this.playAd())},t.prototype.playVpaid=function(t){var e=this;clearTimeout(this.creativeTimeout),this.creativeTimeout=setTimeout(function(){e.creativeAdError("VPAID tag communication timeout",900,50004)},this.scheduledAd.creativeTimeout),this.vastAd=t;var i=h(t,this.getProviderType()),n=this.optionalParams.conditionaladoptout&&t.conditionalAd;if(this.vastAd.selectedMedia=i,this.mediaType=i.type,"flash"===l(i)){var r=this.flashSwf();this.vpaidPlayer=new ce(this.player,r,i.file,this.scheduledAd._currentTag,this.vastAd.adParams,this.optionalParams.vpaidcontrols)}else this.vpaidPlayer=new fe(this.player,i.file,this.scheduledAd._currentTag,this.vastAd.adParams,this.optionalParams.vpaidcontrols,n);this.blockingInstreamPlayer&&this.blockingInstreamPlayer.applyProviderListeners(this.vpaidPlayer),this.vpaidPlayer.blocking=this.blockingInstreamPlayer,this.vpaidPlayer.on("play",this.playHandler,this),this.vpaidPlayer.on("pause",this.pauseHandler,this),this.vpaidPlayer.on("quartile",this.quartileHandler,this),this.vpaidPlayer.on("remainingTimeChange",this.remainingTimeHandler,this),this.vpaidPlayer.on("click",this.clickVpaidHandler,this),this.vpaidPlayer.on("error",this.playbackErrorHandler,this),this.vpaidPlayer.on("impression",this.impressionHandler,this),this.vpaidPlayer.on("expandedChange",this.vpaidExpandedHandler,this),this.vpaidPlayer.on("close",this.adCloseHandler,this),this.vpaidPlayer.on("skipped",this.vpaidAdSkipped,this),this.vpaidPlayer.on("stopped",this.endOfVpaidAdHandler,this),this.vpaidPlayer.on("complete",this.adCompleteHandler,this),this.vpaidPlayer.on("started",this.adStartedHandler,this),this.setupSkipButton()},t.prototype.setupSkipButton=function(){var t=this.optionalParams.skipoffset;t&&this.blockingInstreamPlayer&&(this.blockingInstreamPlayer.off(jt,this.skipVpaidAd,this),this.blockingInstreamPlayer.setupSkipButton(t,this.optionalParams,this.utils.noop),this.blockingInstreamPlayer.on(jt,this.skipVpaidAd,this))},t.prototype.playInstream=function(t,e){var i=this;clearTimeout(this.creativeTimeout),this.creativeTimeout=setTimeout(function(){i.creativeAdError("VAST tag communication timeout",900,60004)},this.scheduledAd.creativeTimeout),this.blockingInstreamPlayer?this.instreamPlayer=this.blockingInstreamPlayer:this.instreamPlayer=this.player.createInstream().init(),this.instreamPlayer.on("play",this.playHandler,this),this.instreamPlayer.on("pause",this.pauseHandler,this),this.instreamPlayer.on("time",this.timeHandler,this),this.instreamPlayer.on("playlistItem",this.playlistItemHandler,this),this.instreamPlayer.on("complete",this.adCompleteHandler,this),this.instreamPlayer.on("playlistComplete",this.endOfAdBreakHandler,this),this.instreamPlayer.on("mute",this.muteHandler,this),this.instreamPlayer.on("instreamClick",this.clickInstreamHandler,this),this.instreamPlayer.on("adSkipped",this.adSkipped,this),this.instreamPlayer.on("error",this.playbackErrorHandler,this),this.instreamPlayer.on("mediaError",this.playbackErrorHandler,this),this.instreamPlayer.loadItem(t,e)},t.prototype.playerFullscreenHandler=function(t){var e=this.getVastAd(this.adPodIndex),i=e.tracker;t.fullscreen&&i.started&&i.fullscreen()},t.prototype.playerResizeHandler=function(t){this.vpaidPlayer&&this.vpaidPlayer.resize(t.width,t.height)},t.prototype.playerVolumeHandler=function(t){this.vpaidPlayer&&this.vpaidPlayer.setVolume(t.volume)},t.prototype.playlistItemHandler=function(t){this.instreamPlayer&&(this.adPodIndex=t.index+this.initialIndex)},t.prototype.impressionHandler=function(t){var e=this.getVastAd(this.adPodIndex),i=e.tracker;i.impression();var n={};n.adposition=this.scheduledAd._position||"",n.adtitle=e.adTitle||"",n.adsystem=e.adsystem||"",n.wrapper=e.wrapper||"",n.vastversion=e.vastversion,n.clickThroughUrl=e.clickthrough,n.duration=e.duration||0,n.mediafile={file:e.selectedMedia.file},n.linear=t.linear||i.linear,this.addConditionalAdData(n),a(e,n),this.triggerEvent(Lt,n)},t.prototype.playHandler=function(t){clearTimeout(this.creativeTimeout);var e=this.getVastAd(this.adPodIndex),i=e.tracker,n=void 0;if(i.started)t.oldstate===kt&&(i.resume(),this.dispatchPlay(t));else{this.vpaidPlayer&&(i.linear=t.linear),this.instreamPlayer&&this.impressionHandler({linear:i.linear});var r=this.utils.extend({linear:i.linear},this.getInstreamOptions(e));r.message=this.optionalParams.dynamicMessage||"",r.clickthrough=e.clickthrough,r.sequence&&(r.podMessage=this.optionalParams.podMessage||""),e.adTitle&&(r.title=e.adTitle),e.companions&&(r.companions=e.companions),this.triggerEvent(Ht,r),e.companions&&(n={},n.companions=s(e.companions),n.universalAdIdRegistry=e.companionUniversalAdIdRegistry,n.universalAdIdValue=e.companionUniversalAdIdValue,this.triggerEvent(xt,n));var a=this.companion,d=void 0;d=this.utils.flashVersion()>9?e.companions:o(e.companions),this.optionalParams.companion&&d&&d.length&&(i.hasComp=a.addCompanion(this.optionalParams.companion,d)),i.start(),i.creativeView(),this.dispatchPlay(t)}},t.prototype.dispatchPlay=function(t){if("static"!==this.adType&&("vpaid"!==this.adType||"linear"===t.linear)){var e=t.oldstate,i=t.newstate,n={};n.oldstate=e,n.newstate=i,this.triggerEvent(Ot,n),this.vpaidPlayer&&this.vpaidPlayer.trigger(At,n)}},t.prototype.pauseHandler=function(t){var e=this.getVastAd(this.adPodIndex),i=e.tracker;i.pause();var n=t.oldstate,r=t.newstate,a={};a.oldstate=n,a.newstate=r,this.triggerEvent(Dt,a),this.vpaidPlayer&&this.vpaidPlayer.trigger(At,{newstate:r,oldstate:n})},t.prototype.remainingTimeHandler=function(t){t.duration?this.duration=t.duration:this.duration=Math.max(1,this.duration,t.remainingTime);var e=t.remainingTime>=0?this.duration-t.remainingTime:0;this.timeHandler({position:e,duration:this.duration,isDurationChange:t.isDurationChange})},t.prototype.quartileHandler=function(t){if(t.duration)this.duration=t.duration;else{var e=4*t.remainingTime/(4-t.quartile);this.duration=Math.max(this.duration,1,e)}this.timeHandler({position:this.duration*t.quartile*.25,duration:this.duration})},t.prototype.timeHandler=function(t){var e=this.getVastAd(this.adPodIndex),i=t.position,n=t.duration,r=n-i,a=e.tracker,s=this.optionalParams.dynamicMessage||"",o=this.optionalParams.podMessage||"";if(s&&r>0){if(s=s.replace(/xx/gi,""+Math.ceil(r)),this.adPodItems&&this.adPodItems.length>1){var d=this.adPodIndex+1;o=o.replace(/__AD_POD_CURRENT__/g,""+d),o=o.replace(/__AD_POD_LENGTH__/g,""+this.adPodItems.length),s=o+s}this.instreamPlayer?this.instreamPlayer.setText(s):this.vpaidPlayer&&this.vpaidPlayer.blocking&&this.vpaidPlayer.blocking.setText(s)}if(!t.isDurationChange){a&&a.time(i,n);var l={};l.position=i,l.duration=n,this.triggerEvent(Ut,l)}},t.prototype.combinedCompleteHandler=function(){this.adCompleteHandler(),this.endOfAdBreakHandler()},t.prototype.adCompleteHandler=function(){var t=this.getVastAd(this.adPodIndex),e=t.tracker;e.firedError||(e.complete(),this.triggerEvent(Vt))},t.prototype.adCloseHandler=function(){var t=this.getVastAd(this.adPodIndex),e=t.tracker;e.firedError||e.close()},t.prototype.adStartedHandler=function(){this.triggerEvent(Bt)},t.prototype.endOfVpaidAdHandler=function(){return this.adPodItems&&this.adPodItems.length-1>this.adPodIndex?(this.vpaidPlayer&&this._.isFunction(this.vpaidPlayer.destroy)&&this.vpaidPlayer.destroy(),this.vpaidPlayer=null,this.adPodIndex++,void this.playAd()):void this.endOfAdBreakHandler()},t.prototype.endOfAdBreakHandler=function(){this.removePlayerListeners(),this.trigger(Vt)},t.prototype.muteHandler=function(t){var e=this.getVastAd(this.adPodIndex),i=e.tracker;i&&(t.mute?(i.mute(),this.vpaidPlayer&&this.vpaidPlayer.setVolume(0)):(i.unmute(),this.vpaidPlayer&&this.vpaidPlayer.setVolume(this.player.getVolume()/100)))},t.prototype.clickStaticHandler=function(){var t=this.getVastAd(this.adPodIndex);this.player.pause(!0),this.clickThrough(t)},t.prototype.clickVpaidHandler=function(t){var e=this.getVastAd(this.adPodIndex),i=!0;t&&t.url&&(t.playerHandles===!1&&(i=!1),e.clickthrough=t.url),this.clickThrough(e,i)},t.prototype.clickInstreamHandler=function(){this.instreamPlayer.getState()!==kt&&this.clickThrough(this.getVastAd(this.adPodIndex))},t.prototype.clickThrough=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.tracker.click(),this.triggerEvent(St),window.jwcast&&window.jwcast.player.id||t.clickthrough&&e&&window.open(t.clickthrough)},t.prototype.skipVpaidAd=function(){this.endOfVpaidAdHandler(),this.vpaidAdSkipped()},t.prototype.vpaidAdSkipped=function(){this.adSkipped(),this.endOfVpaidAdHandler()},t.prototype.adSkipped=function(){this.getVastAd(this.adPodIndex).tracker.skip(),this.triggerEvent(jt)},t.prototype.playbackErrorHandler=function(t){var e=t.message||"Error Playing Ad Tag",i=t.code;(!i||i<=4)&&(i=400),this.vpaidPlayer&&this._.isFunction(this.vpaidPlayer.off)?(this.vpaidPlayer.off(),this.creativeAdError(e,i,t.adErrorCode)):this.adError(e,i,t.adErrorCode)},t.prototype.staticErrorHandler=function(){this.adError("Unable to fetch NonLinear resource",502)},t.prototype.vpaidExpandedHandler=function(t){var e=this.getVastAd(this.adPodIndex),i=e.tracker;t.expanded?i.expand():i.collapse()},t.prototype.triggerEvent=function(t,e){var i=this.adEventObject(t);e&&this.utils.extend(i,e),he.indexOf(t)!==-1?this.trigger(t,i):this.player.trigger(t,i)},t.prototype.addConditionalAdData=function(t){this.vastAd&&(t.conditionalAd=this.vastAd.conditionalAd),this.vastAdPod&&this.vastAdPod.length&&(t.conditionalAd=this.vastAdPod[this.adPodIndex].conditionalAd),t.conditionalAdOptOut=this.optionalParams.conditionaladoptout},t}(),ke=jwplayer.utils,Te=jwplayer._,Ee=function(){function t(e,i){ue(this,t),this.debugTrackFn=e,this.div=null,this.elem=null,this.environment=i}return t.prototype.addCompanion=function(t,e){if(this.div=t,this.elem=document.getElementById(this.div.id),!this.elem)return!1;for(var i=0;i<e.length;i++)if(this.fitsDiv(e[i]))return this.placeCompanion(e[i]),!0;return!1},t.prototype.removeCompanion=function(){this.elem.innerHTML=""},t.prototype.sendPings=function(t){t=t.creativeView,t&&(Te.map(t,function(t){var e=new Image;e.src=t}),Te.isFunction(this.debugTrackFn)&&this.debugTrackFn({type:"companion",data:{trackers:t}}))},t.prototype.placeCompanion=function(t){if(this.removeCompanion(),"html"===t.type){var e=document.createElement("div");e.innerHTML=t.source;var i=e.getElementsByTagName("script");return i.length&&Te.map(i,function(t){var e=new ke.scriptloader(t.src);e.load(),t.parentElement.removeChild(t)}),this.elem.appendChild(e),void this.sendPings(t.trackers)}if("iframe"===t.type){var n=document.createElement("iframe");return n.height=this.div.height,n.width=this.div.width,n.src=t.source,n.scrolling="no",n.style.border="none",n.marginWidth=0,n.marginHeight=0,this.sendPings(t.trackers),this.elem.innerHTML="",void this.elem.appendChild(n)}if("application/x-shockwave-flash"===t.type){if(this.environment.Browser.msie)this.elem.innerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"\n                    width="100%" height="100%"\n                    id="'+this.elem.id+'" name="'+this.elem.id+'"\n                    tabindex=0">\n                    <param name="movie" value="'+t.source+'">\n                    <param name="allowfullscreen" value="true">\n                    <param name="allowscriptaccess" value="always">\n                    <param name="scale" value="exactfit">\n                    <param name="seamlesstabbing" value="true">\n                    <param name="wmode" value= "opaque">\n                </object>';else{var r=document.createElement("object");r.setAttribute("type","application/x-shockwave-flash"),r.setAttribute("data",t.source),r.setAttribute("width","100%"),r.setAttribute("height","100%"),r.setAttribute("tabindex",0),c(r,"allowfullscreen","true"),c(r,"allowscriptaccess","always"),c(r,"seamlesstabbing","true"),c(r,"wmode","opaque"),this.elem.appendChild(r)}return void this.sendPings(t.trackers)}var a=new Image;a.src=t.source,ke.exists(t.clickthrough)&&(a.onclick=function(){var e=window.open(t.clickthrough,"_blank");e.focus()}),this.elem.innerHTML="",this.elem.appendChild(a),this.sendPings(t.trackers)},t.prototype.fitsDiv=function(t){return t.width===this.div.width&&t.height===this.div.height},t}(),we=jwplayer.utils,be=jwplayer._,_e=function(){function t(){ue(this,t),this.preRoll=null,this.vmap=null,this.postRoll=null,this.midRolls=[],this.playedMidRolls=[]}return t.prototype.setPreRoll=function(t){this.preRoll=t},t.prototype.getPreRoll=function(){return m(this.preRoll,this.requestTimeout,this.creativeTimeout)},t.prototype.getPostRoll=function(){return m(this.postRoll,this.requestTimeout,this.creativeTimeout)},t.prototype.getNextMidRoll=function(t,e){if(this.sort(e),this.midRolls.length>this.playedMidRolls.length){var i=this.getClosestIndex(t,e);if(i>=0&&this.playedMidRolls.indexOf(i)<0){var n=this.midRolls[i];return this.playedMidRolls.push(i),m(n,this.requestTimeout,this.creativeTimeout)}}return null},t.prototype.getMidRolls=function(){var t=[];return we.foreach(this.midRolls,function(e,i){t.push(m(i))}),t},t.prototype.reset=function(){this.playedMidRolls=[]},t.prototype.addMidRoll=function(t){this.midRolls.push(t)},t.prototype.setPostRoll=function(t){this.postRoll=t},t.prototype.sort=function(t,e){(!t||t<1)&&(t=1),this.midRolls.sort(function(e,i){return v(e._offSet,t)-v(i._offSet,t)}),f(this.getAllAds(),e)},t.prototype.getAllAds=function(){var t=this.preRoll?[this.preRoll]:[],e=this.postRoll?[this.postRoll]:[];return t.concat(this.midRolls,e)},t.prototype.getAdScheduleEventObject=function(){var t=this.getAllAds(),e=[],i={tag:this.getVMAP(),client:"vast",adbreaks:[]};return be.map(t,function(t){var i={type:t._type,offset:t._offSet};t._vmap?i.vmap=t._vmap:i.adbreak=t._adbreak,e.push(i)}),i.adbreaks=e,i},t.prototype.setVMAP=function(t){this.vmap=t},t.prototype.isVMAP=function(){return!!this.vmap},t.prototype.getVMAP=function(){return this.vmap},t.prototype.getClosestIndex=function(t,e){for(var i=this.midRolls.length;i--;)if(t>=v(this.midRolls[i]._offSet,e))return i;return-1},t}(),Ce=jwplayer._,Ie=jwplayer.utils,Se=function(){function t(){ue(this,t)}return t.prototype.getSchedule=function(t){var e=new _e;if(e.requestTimeout=A(t.requestTimeout,yt),e.creativeTimeout=A(t.creativeTimeout,gt),t.tag)e.setPreRoll({_offSet:"pre",_adQueue:y(t.tag),_waterfallIndex:0});else if(Ce.isString(t.vastxml))e.setPreRoll({_offSet:"pre",_adXML:t.vastxml});else{if(Ce.isString(t.schedule))return e.setVMAP(t.schedule),e;if(Ce.isString(t.adschedule))return e.setVMAP(t.adschedule),e;k(e,t)}return e.sort(),e},t.prototype.getOptParams=function(t){var e={cuetext:t.cuetext||ot,dynamicMessage:t.admessage||rt,podMessage:t.podmessage||at,skipoffset:t.skipoffset||st,skipMessage:t.skipmessage||dt,skipText:t.skiptext||lt,vpaidcontrols:t.vpaidcontrols||!1,conditionaladoptout:t.conditionaladoptout||!1},i=t.companiondiv;return i&&(e.companion={id:i.id,height:i.height,width:i.width}),e},t}(),xe=jwplayer.utils,Ve=xe.UI,Re=document.createElement("img"),Le=document.createElement("img");Re.src=Le.src='data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><circle cx="32" cy="32" r="32" fill="#191919"/><line stroke="#CCC" stroke-width="6" x1="32" y1="20" x2="32" y2="44"/><line stroke="#CCC" stroke-width="6" x1="20" y1="32" x2="44" y2="32"/></svg>',Re.className="jw-vast-nonlinear-open-button",Le.className="jw-vast-nonlinear-close-button";var Me={cursor:"pointer",position:"absolute",margin:"auto",left:0,right:0,bottom:0,display:"block"},He="opacity 0.2s",De={"-webkit-transition":He,transition:He},Oe=function(){function t(e,i,n,r,a){ue(this,t),this.player=e,this.environment=e.getEnvironment(),this.div=r,this.staticURL=i,this.clickURL=n,this.loadTimer=-1,this.animationTimer=-1,this.banner=null,xe.extend(this,e.Events),this.banner=document.createElement("img"),this.banner.className="jw-banner",this.banner.id=this.player.id+"_vast_static",E([Le,Re]),this.remove(Re),this.div.appendChild(this.banner),this.div.appendChild(Le),this.loadTimer=setTimeout(this.imageLoadError.bind(this),a),this.banner.onerror=this.imageLoadError.bind(this),this.banner.onload=this.onLoaded.bind(this),this.banner.src=this.staticURL}return t.prototype.onLoaded=function(){return clearTimeout(this.loadTimer),0===this.banner.naturalWidth?void this.imageLoadError():(this.removeBannerEventListeners(),xe.style(Le,{top:-this.banner.height-8,bottom:this.banner.height-8,left:this.banner.width},!0),xe.style(Re,{top:-16},!0),T([this.div,this.banner]),T(Le,.75),new Ve(this.banner).on("click tap",this.sendClick.bind(this)),this.environment.OS.mobile&&(this.div.onmouseover=w,this.div.onmouseout=b),Le.onclick=Le.ontouchstart=this.collapse.bind(this),Re.onclick=Re.ontouchstart=this.expand.bind(this),void this.trigger(qt.PLAY))},t.prototype.imageLoadError=function(){clearTimeout(this.loadTimer),this.trigger(qt.ERROR),this.removeBanner()},t.prototype.sendClick=function(){this.trigger(qt.CLICK)},t.prototype.collapse=function(t){var e=this;this.animationTimer===-1&&(t.preventDefault(),this.div.onmouseover=this.div.onmouseout=null,E([this.banner,Le,Re]),this.div.appendChild(Re),this.animationTimer=setTimeout(function(){e.remove(e.banner),e.remove(Le),T(Re,.5),e.div.onmouseover=_,e.div.onmouseout=C,e.animationTimer=-1},250))},t.prototype.expand=function(t){var e=this;this.animationTimer===-1&&(t.preventDefault(),this.div.onmouseover=this.div.onmouseout=null,this.div.appendChild(this.banner),this.div.appendChild(Le),this.animationTimer=setTimeout(function(){T([e.banner,Le]),e.div.onmouseover=w,e.div.onmouseout=b,e.animationTimer=-1},50),E(Re))},t.prototype.remove=function(t){this.div.contains(t)&&this.div.removeChild(t)},t.prototype.removeBannerEventListeners=function(){this.banner.onload=this.banner.onerror=null},t.prototype.removeBanner=function(){this.removeBannerEventListeners(),this.remove(this.banner)},t.prototype.removeListeners=function(){clearTimeout(this.loadTimer),clearTimeout(this.animationTimer),this.div.onmouseover=this.div.onmouseout=Le.onclick=Re.onclick=null,this.off(),this.removeBannerEventListeners()},t.prototype.stop=function(){E([this.div,this.banner,Le,Re]),setTimeout(this.removeBanner.bind(this),400),this.remove(Le),this.remove(Re)},t}(),je=function(){function t(e,i){ue(this,t),this.player=e,this.div=i,this.startTime=0,this.minDur=0,this.environment=e.getEnvironment(),xe.extend(this,e.Events),this.type="static",e.on("time",this.dispatchTime,this)}return t.prototype.playAd=function(t,e,i,n,r){this.minDur=xe.seconds(i),this.adTag=n,this["static"]&&(this["static"].removeListeners(),this["static"].stop()),this.div.style.opacity=0,this.div.style.visibility="visible";var a=this.environment.Browser.firefox?{}:De;xe.style(this.div,xe.extend({top:"",position:"absolute",width:"100%"},a)),xe.style([Le,Re],xe.extend({width:"18px",height:"18px",opacity:.75},Me,a)),xe.style(Le,{transform:"rotate(45deg)"}),this["static"]=new Oe(this.player,t,e,this.div,r),this["static"].on(qt.PLAY,this.startAd,this),this["static"].on(qt.CLICK,this.clickHandler,this),this["static"].on(qt.ERROR,this.errorHandler,this)},t.prototype.dispatchTime=function(t){this.trigger(ht,t)},t.prototype.startAd=function(){this.startTime=this.player.getPosition(),this.minDur>0&&(0===this.startTime?this.on(ht,this.startTimingAd,this):this.on(ht,this.timeAd,this)),this.sendEvent(qt.PLAY)},t.prototype.startTimingAd=function(t){this.startTime=t.position,this.off(ht,this.startTimingAd,this),this.on(ht,this.timeAd,this)},t.prototype.timeAd=function(t){var e=t.position-this.startTime;e>this.minDur&&(this.off(ht,this.timeAd,this),this.stop())},t.prototype.clickHandler=function(){this.sendEvent(qt.CLICK)},t.prototype.errorHandler=function(){this.sendEvent(qt.ERROR)},t.prototype.sendEvent=function(t,e){e=e||{},e.tag=e.tag||this.adTag,this.trigger(t,e)},t.prototype.removeEvents=function(){this.off()},t.prototype.getState=function(){return Et},t.prototype.stop=function(){this.startTime&&this["static"]&&(this.startTime=0,this.minDur=0,this.off(ht,this.startTimingAd,this),this.off(ht,this.timeAd,this),this["static"].removeListeners(),this["static"].stop(),this.sendEvent(qt.COMPLETE))},t.prototype.pause=function(){},t}(),Ue=jwplayer.utils,Be=jwplayer._,Ne=function(){function t(e){ue(this,t),this._parsedAds=[],this._error=null,this._version=null,e&&this.parse(e)}return t.prototype.parsedAds=function(){return this._parsedAds},t.prototype.error=function(){return this._error},t.prototype.version=function(){return this._version},t.prototype.parse=function(t){var e=this,i=void 0,n=void 0,r=[];"VAST"===t.nodeName?i=t:(i=V(t,"VAST")[0],i||(i=V(t,"VideoAdServingTemplate")[0])),i||this.throwError(101,"Invalid VAST response"),n="VideoAdServingTemplate"===i.tagName?1:parseFloat(L(i,"version")||0),this._version=n;var a=V(i,"Ad");Be.map(a,function(t){var i=e.parseAd(n,t);i.vastversion=n,r.push(i)}),this._parsedAds=r,this._parsedAds.length||x(i)},t.prototype.parseAd=function(t,e,i){i=i||{};var n=V(e,"InLine")[0],r=V(e,"Wrapper")[0],a=n?n:r,s=a?H(V(a,"AdTitle")[0]):"",o=void 0;return i.sequence=L(e,"sequence"),i.adTitle=s,(!t||t>4||t<2)&&this.throwError(102,"Vast version not supported"),4===t&&(i.conditionalAd=!!L(e,"conditionalAd")),a?(t>=2?(o=U(a),O(a,"Impression",o.trackers),O(a,"Error",o.trackers)):o=B(a),j(o),r&&(o.wrappedURI=H(V(r,"VASTAdTagURI")[0])||H(V(r,"VASTAdTagURL")[0])),o=Q(i,o)):2===t?this.throwError(900,"Invalid VAST response",60001):this.throwError(101,"Invalid VAST response",10101),o},t.prototype.throwError=function(t,e,i){var n=this;i=i||1e4+t;var a=r(e,t,i);throw a.toString=function(){return n.code+" "+n.message},this._error=a,this._error},t}(),Fe=function(){function t(e,i,n){ue(this,t),this._scheduledAd=e,this.player=i,this.utils=i.utils,this._=i._,this.options=n||{},this.utils.extend(this,i.Events),this._history=[],this.loadedAds=[],this.parser=null,this.xmlhttp=null,this.errorSent=!1}return t.prototype.flashSwf=function(){var t=this.player.getContainer();return t.querySelector("object")},t.prototype.genCallback=function(t,e){var i=this.player.id+":vast:"+e.name+":"+Math.random().toString(16).substr(2);return t.on(i,e,this),i},t.prototype.load=function(t){this._history.push(t),this.errorSent=!1,this.xmlhttp=this.getXhrRequest(t)},t.prototype.getXhrRequest=function(t){var e=this,i=function(i){e.ajaxComplete(i,t)},n=function(i,n){if(e.player){var s=e.flashSwf();return s&&"Invalid XML"!==i&&"Timeout"!==i&&e.utils.crossdomain(n)?void s.triggerFlash("loadXml",n,e.genCallback(s,r),e.genCallback(s,a)):void e.ajaxError(i,t)}},r=function(i){e.parseXmlString(i,t)},a=function(i){e.utils.log(i),e.ajaxError(i,t)};return this.utils.ajax(t,i,n,{withCredentials:!0,retryWithoutCredentials:!0,requireValidXML:!0,timeout:this._scheduledAd.requestTimeout})},t.prototype.destroy=function(){X(this.xmlhttp),this.player=null},t.prototype.scheduledAd=function(){return this._scheduledAd},t.prototype.allAds=function(){return this.loadedAds},t.prototype.adPod=function(){var t=[];return this.utils.foreach(this.loadedAds,function(e,i){i.sequence&&t.push(i)}),t.sort(function(t,e){return t.sequence-e.sequence}),t},t.prototype.adBuffet=function(){var t=[];return this.utils.foreach(this.loadedAds,function(e,i){i.sequence||t.push(i)}),t},t.prototype.history=function(){return this._history},t.prototype.parseXmlString=function(t,e){this.ajaxComplete({responseXML:G(t,this.utils)},e)},t.prototype.ajaxComplete=function(e,i){var n=this;this.parser=this.parser||new Ne;try{this.parser.parse(e.responseXML)}catch(r){var a=r.code||900,s=r.adErrorCode||1e4+a;return void this.sendErrorEvent(r.message,a,s,i)}var o=this.parser.parsedAds();if(o&&o.length)this.loadedAds=o,this.options.wrapper=this.options.wrapper||[],this.options.wrapper.push(this.loadedAds[0].adsystem),this.utils.foreach(this.loadedAds,function(e,i){if(i.wrappedURI){n.options.wrappedTags=n.options.wrappedTags||[],n.options.wrappedTags.push(i.wrappedURI);var r=new t(n._scheduledAd,n.player,n.options);r.on(wt,function(){n.replaceWrappedAd(i,r.allAds())}),r.on(It,function(t){n.sendAdpodErrorEvent(t.message,t.code,t.adErrorCode,t.url),n.destroyWrappedAd(i,r)}),r.load(i.wrappedURI)}else n.options.wrapper.length>1&&(i.wrapper=n.options.wrapper.slice(0,-1),i.wrappedTags=n.options.wrappedTags)}),this.checkComplete();else{var d=2===this.parser.version(),l=d?900:101,h=d?60001:10101;this.sendErrorEvent("Ad Tag Empty",l,h,i)}},t.prototype.destroyWrappedAd=function(t,e){var i=this._.indexOf(this.loadedAds,t);this.loadedAds.splice(i,1),e.destroy(),this.checkComplete()},t.prototype.replaceWrappedAd=function(t,e){var i=W(t,e,this.utils),n=this._.indexOf(this.loadedAds,t);Array.prototype.splice.apply(this.loadedAds,[n,1].concat(i)),this.checkComplete()},t.prototype.checkComplete=function(){var t=!1;this.utils.foreach(this.loadedAds,function(e,i){i.wrappedURI&&(t=!0)}),t||this.validateVast()},t.prototype.validateVast=function(){var t=this.loadedAds.slice(0),e=t.length;this._.map(t,function(e){e.media&&e.media.length||t.length--});var i=0===e,n=t.length!==e;return i||n?void this.sendErrorEvent("Ad Tag Empty",101,10101,this._history[this._history.length-1]):void this.trigger(wt,{vloader:this})},t.prototype.ajaxError=function(t,e){if(this.player.getAdBlock())this.sendErrorEvent("Ad playback blocked by an ad blocker",900,60003,e);else if("Invalid XML"===t)this.sendErrorEvent(t,100,10100,e);else if("Error loading file"===t){var i=this.options.wrappedTags&&this.options.wrappedTags.length,n=i?303:900,r=i?10303:60006;this.sendErrorEvent(t,n,r,e)}else this.sendErrorEvent("VAST could not be loaded",301,10301,e)},t.prototype.firstUrl=function(){return this._history&&this._history.length?this._history[0]:""},t.prototype.sendAdpodErrorEvent=function(t,e,i,n){if(1===this.loadedAds.length)return void this.sendErrorEvent(t,e,i,n);var a=r(t,e,i);a.vloader=this,a.url=this.firstUrl()||n,this.wrappedUrl=n,this.trigger("adPodError",a)},t.prototype.sendErrorEvent=function(t,e,i,n){if(!this.errorSent){this.errorSent=!0;var a=r(t,e,i);a.vloader=this,a.url=this.firstUrl()||n,a.wrappedUrl=n,this.trigger(It,a)}},t}(),qe={},Qe=function(t,e){var i=this,n=qe[e];return n?n:(function(t,e){t.jwplayerEntitlements=e()}(this,function(){return function(t,e,i){var n={canPlayAds:!0},r=new t.key(e),a=r.edition();if("unlimited"===a)return i(n);var s=r.token(),o=["//","entitlements.jwplayer.com","/",s,".json"];"file:"===window.location.protocol&&o.unshift("https:"),t.ajax(o.join(""),function(t){n.canPlayAds=!t||!t.response||t.response.canPlayAds!==!1,i(n)},function(){i(n)},{timeout:1e4,responseType:"json"})}}),qe[e]=new Promise(function(n,r){i.jwplayerEntitlements(t,e,function(t){return t.canPlayAds?void n():void r({message:"Ad Limit Reached"})})}))},Xe=/^((https?:)?\/\/)?(secure)?pubads\.g\.doubleclick\.net\/gampad\/ads\?[\S]*$/,We=/^((https?:)?\/\/)?bid\.g\.doubleclick\.net\/dbm\/vast\?[\S]*$/,ze=/^((https?:)?\/\/)?ad\.doubleclick\.net(\/ddm)?\/pfadx\/[\S]*$/,Ge=function(t,e,i){
function n(e){if(e){bt&&(C(bt),bt=null);var i=function(i){bt=null;try{for(var n=I(i.responseXML,_t),a=0;a<n.length;a++){var s=n[a];s.vmap=e,t.trigger(Rt,s)}t.trigger("adSchedule",_t.getAdScheduleEventObject())}catch(o){var d=r("VMAP Schema Error: "+o.message,1002,11002);return d.id=nt,d.vmap=e,void F(d)}if(at&&(Q(_t),Tt)){var h=l({type:Mt});h&&U()}},n=function(t){bt=null,W.log(t),Tt&&U();var i={Timeout:1007,"Invalid XML":1e3,"default":1008},n=i[t]||i["default"],a=1e4+n,s=r("Error Loading VMAP Schedule",n,a);s.id=nt,s.vmap=e,F(s)};bt=W.ajax(e,i,n,{withCredentials:!0,retryWithoutCredentials:!0,requireValidXML:!0,timeout:_t.requestTimeout})}}function a(){at=!0,Pt=new je(t,i),kt=new Ee(Z,z),rt=Ct.getOptParams(e)}function s(t){ut=!!t.active}function o(t){tt.trigger(Et,t)}function d(){var e=t.getConfig().mediaElement,i="pre"===st||t.isBeforePlay()||0===t.getPosition(),n=z.Browser.safari&&z.Browser.version.major>=11||z.OS.mobile&&!J&&!!e.src,r=i&&n;r&&e.load(),y()}function l(t){if(ut)return!1;var e=_t.getPreRoll();return bt?(d(t),!1):!(!ot&&e)||(At=u(e),c(e,t),!1)}function h(t){if(!ut&&0!==t.duration){var e=_t.getNextMidRoll(t.position,t.duration);e&&(At=u(e),f(e,t))}}function p(t){if(!ut){var e=_t.getPostRoll();!dt&&e&&(At=u(e),m(e,t))}}function u(e){return e._trackers?new ge(e._trackers,Z,t):null}function c(t,e){t._position="pre",ot=!0,t._id=T(12),v(t,e)}function f(t,e){t._position="mid",t._id=T(12),v(t,e)}function m(e,i){e._position="post",dt=!0,t.detachMedia(),e._id=T(12),v(e,i)}function v(t,e){st=t._position,clearTimeout(mt),mt=-1,"nonlinear"!==t._type&&(Tt||d(e)),t._adXML?(t._currentTag=t._currentTag||"clientloadedtag_"+lt++,k(t)):t._adQueue?P(t):(W.log("scheduled ad has no url or xml",t),U())}function y(){tt.off(Et,y),Tt=t.createInstream().init(),tt.trigger("blockingStarted")}function g(e){var i=_t;A(e),_t.isVMAP()?i!==_t&&n(Y(_t.getVMAP(),t,q(),rt)):t.trigger("adSchedule",_t.getAdScheduleEventObject())}function A(e){var i=t.getPlaylistItem(e.index);_t=K.isObject(i)&&i.adschedule?Ct.getSchedule(i):St,L(),M(),j(),dt=!1,ot=!1,Q(_t),_t.reset()}function P(e){ct=e;var i=e._waterfallIndex||0,n=e._adQueue[i],r=Y(n,t,q(),rt);e._waterfallIndex=i+1,e._currentTag=r,K.isFunction(Z)&&Z({type:"tagReplacement",data:{actualTag:r,originalTag:n}}),E(e,r),b(e).load(r)}function k(t){t._currentTag=t._currentTag||t._adXML.toString(),E(t,t._currentTag),b(t).parseXmlString(t._adXML)}function T(t){return new Array(t+1).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,t)}function E(e,i){t.trigger("adRequest",w(e,i)),tt._qoe.tick("adLoading"+e._id)}function w(t,e){var i=t._adQueue||{},n={},r=t.adbreakid,a=t._adTagQueue,s=t.skipoffset;if(r&&(n.adbreakid=r),a){var o=t._waterfallIndex-1;o=o<0?0:o,n.adtagid=a[o]}return K.isUndefined(s)||(n.skipoffset=s),K.extend(n,{id:t._id,tag:e||t._currentTag,client:"vast",adposition:t._position,offset:t._offSet,witem:t._waterfallIndex||1,wcount:i.length||1})}function b(e){var i=new Fe(e,t);return i.on(wt,x),i.on(It,N),i.on("adPodError",B),ht.push(i),At&&!At.started&&At.breakStart(),i}function _(t){for(var e=ht.length;e--;)ht[e]===t&&(ht.splice(e,1),t.destroy())}function C(t){t.onload=null,t.onreadystatechange=null,t.onerror=null,"abort"in t&&t.abort()}function S(){bt&&(C(bt),bt=null),L(),M(),j(),t.setCues([])}function x(t){var e=t.vloader.scheduledAd();Tt||"nonlinear"===e._type?V(t):(tt.off("blockingStarted"),tt.once("blockingStarted",function(){V(t)}))}function V(e){var i=e.vloader;clearTimeout(mt),mt=-1,ct.isWaterfalling||j(),_(i);var n=new Pe(i,t,Pt,kt,rt,Z);n.on(Rt,H),n.on(Lt,D),n.on("adPodError",F);var r=n.init(Tt);return r?(vt=Tt,Tt=null,tt.off("blockingStarted"),tt.off(Et,y),vt&&vt.on("adBreakEnd",function(){At&&At.breakEnd()}),n.on(Vt,O),void pt.push(n)):void n.destroy()}function R(){j(),dt=!1,ot=!1}function L(){for(var t=ht.length;t--;){var e=ht[t];ht.length--,e.destroy()}}function M(){tt.off(Et,y);for(var t=pt.length;t--;){var e=pt[t];pt.length--,e.destroy()}}function H(e){if(ft=!1,F(e),!ft&&et(ct)){Tt=Tt||vt;var i=K.extend({},ct);return i._offset=0,i.isWaterfalling=!0,void v(i)}M(),ft=!1,mt=setTimeout(function(){mt=-1,0===ht.length&&("post"===st&&t.attachMedia(),U())},0)}function D(e){if(ct={},"pre"===e.adposition&&(void 0===e.podcount||1===e.sequence)){tt._qoe.tick("adImpression"+e.id);var i=tt._qoe.between("adLoading"+e.id,"adImpression"+e.id);e.timeLoading=i}t.trigger(Lt,e)}function O(){0===ht.length&&"post"===st&&t.attachMedia()}function j(){if(pt.length){var t=pt[pt.length-1];t.clearNonlinear()}}function U(){if(Tt){var t=Tt;Tt=null,t.destroy(),tt.off("blockingStarted"),tt.off(Et,y)}vt=null}function B(t){var e=t.vloader,i=w(e.scheduledAd(),t.url),n=r(t.message,t.code,t.adErrorCode);W.extend(i,n),t.wrappedUrl!==t.url&&(i.wrappedTag=t.wrappedUrl),ft=!1,F(i)}function N(e){var i=e.vloader,n=i.allAds();if(_(i),n&&n.length){var r=n[0];if(r){var a=r.trackers;if(a&&a.error){var s=new ge(a,Z,t);s.error(e.code)}}}if(B(e),!ft&&et(ct)){var o=K.extend({},ct);return o._offset=0,o.isWaterfalling=!0,void v(o)}M(),ft=!1,mt===-1&&(mt=setTimeout(function(){mt=-1,0===ht.length&&U()},0))}function F(e){W.extend(e,{client:"vast"}),At&&At.error(e.code),t.trigger(Rt,e)}function q(){var t=window.location.href;return t=t.match(new RegExp(/^[^\/]*:\/\/\/?([^\/]*)/)),t&&t.length>1?t[1]:""}function Q(e){var i=e.getMidRolls(),n=[];i.length&&W.foreach(i,function(t,e){"nonlinear"!==e._type&&n.push({begin:e._offSet,text:rt.cuetext})}),t.setCues(n)}var X=this,W=t.utils,z=t.getEnvironment(),G=t.getConfig().key,K=t._,$=t.getConfig(),J=!!$.sdkplatform,Z=e.debug&&e.trackFn?e.trackFn:null,tt=this,rt={},at=!1,st="",ot=!1,dt=!1,lt=0,ht=[],pt=[],ut=!1,ct={},ft=!1,mt=-1,vt=void 0,At=void 0,Pt=void 0,kt=void 0,Tt=void 0,bt=void 0,_t=void 0,Ct=new Se;this.version="8.0.3",tt._qoe=new jwplayer.utils.Timer;var St=_t=Ct.getSchedule(e);_t.isVMAP()&&n(Y(_t.getVMAP(),t,q(),rt)),W.extend(this,t.Events),W.addClass(i,"jw-plugin-vast"),t.on("destroyPlugin",function(){S()}),t.on({ready:a,beforePlay:l,cast:s,play:o,time:h,beforeComplete:p,playlistItem:g,playlistComplete:A,complete:R},this),t.pauseAd=function(t){if(t=!K.isBoolean(t)||t,pt.length){var e=pt[pt.length-1];t?e.pause():e.play()}},t.playAd=function(t){ft=!0,j();var e=void 0,i=0===rt.requestTimeout?1/0:rt.requestTimeout,n=0===rt.creativeTimeout?1/0:rt.creativeTimeout;e=K.isArray(t)?t.slice(0):[t];var r={_id:T(12),_adQueue:e,_waterfallIndex:0,_offset:0,_position:"api",requestTimeout:i||yt,creativeTimeout:n||gt};v(r)},Qe.call(this,W,G)["catch"](function(e){S(),t.off(null,null,X),t.playAd=W.noop;var i=r("Ad Error: "+e.message,null,60002);i.code=void 0,i.id=nt,i.client=it,i.tag="",t.trigger(Rt,i)}),this.destroy=S},Ke=window.jwplayerPluginJsonp||window.jwplayer().registerPlugin;Ke(it,"8.0",Ge)}();
